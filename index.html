<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <!-- باقي الhead كما هو -->
</head>
<body>
    <!-- باقي الهيكل كما هو -->

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ... الكود السابق ...

            // Submit order - تم التعديل هنا
            submitBtn.addEventListener('click', () => {
                const name = document.getElementById('customer-name').value;
                const phone = document.getElementById('customer-phone').value;
                const orderType = document.querySelector('.order-type-btn.active').getAttribute('data-type');
                const address = document.getElementById('delivery-address').value;
                const tableNumber = document.getElementById('table-number').value;
                const notes = document.getElementById('order-notes').value;
                
                if (!name || !phone) {
                    showNotification('الرجاء إدخال الاسم ورقم الهاتف', 'error');
                    return;
                }
                
                if (orderType === 'delivery' && !address) {
                    showNotification('الرجاء إدخال عنوان التوصيل', 'error');
                    return;
                }
                
                if (orderType === 'dine-in' && !tableNumber) {
                    showNotification('الرجاء إدخال رقم الطاولة', 'error');
                    return;
                }
                
                // إنشاء رقم طلب فريد
                const orderId = Date.now();
                
                const order = {
                    id: orderId,
                    name,
                    phone,
                    orderType,
                    address: orderType === 'delivery' ? address : null,
                    tableNumber: orderType === 'dine-in' ? tableNumber : null,
                    notes,
                    items: cart,
                    total: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0),
                    status: 'pending',
                    timestamp: new Date().toISOString()
                };
                
                // حفظ الطلب في localStorage
                const orders = JSON.parse(localStorage.getItem('restaurant-orders') || []);
                orders.push(order);
                localStorage.setItem('restaurant-orders', JSON.stringify(orders));
                
                // إرسال إشعار إلى صفحة المسؤول
                const newOrders = JSON.parse(localStorage.getItem('new-orders') || []);
                newOrders.push(orderId);
                localStorage.setItem('new-orders', JSON.stringify(newOrders));
                localStorage.setItem('new-order-notification', 'true');
                
                // Reset and close
                cart = [];
                updateCart();
                orderModal.classList.remove('open');
                document.querySelector('form').reset();
                
                showNotification('تم استلام طلبك بنجاح! رقم الطلب: #' + orderId.toString().slice(-6), 'success');
            });

            // إصلاح مشكلة إضافة إلى السلة
            document.querySelectorAll('.add-to-cart').forEach(button => {
                button.addEventListener('click', function() {
                    const name = this.getAttribute('data-name');
                    const price = parseFloat(this.getAttribute('data-price'));
                    
                    // التأكد من أن البيانات موجودة
                    if (!name || isNaN(price)) {
                        console.error('بيانات المنتج غير صالحة');
                        return;
                    }
                    
                    // Check if item already in cart
                    const existingItem = cart.find(item => item.name === name);
                    
                    if (existingItem) {
                        existingItem.quantity += 1;
                    } else {
                        cart.push({
                            name,
                            price,
                            quantity: 1
                        });
                    }
                    
                    updateCart();
                    showNotification('تم إضافة المنتج إلى السلة بنجاح!');
                });
            });

            // ... باقي الكود ...
        });
    </script>
</body>
</html>